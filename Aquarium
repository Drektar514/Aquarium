using System;
using System.Collections.Generic;

namespace Aquarium
{
    class Aquarium
    {
        private List<Fish> _fishes;
        private int _maxFishCount;

        public Aquarium(int maxFichCount)
        {
            _fishes = new List<Fish>();
            _maxFishCount = maxFichCount;
        }

        public void Play()
        {
            bool play = true;
            while (play)
            {
                Console.WriteLine("Аквариум в работе, вы можете:\n1 - Добавить рыбку.\n2 - Убрать рыбку.\n3 - Уйти от аквариума.");
                ShowAllFishes();
                string _userInput = Console.ReadLine();

                switch (_userInput)
                {
                    case "1":
                        AddFish();
                        break;

                    case "2":
                        RemoveFish();
                        break;

                    case "3":
                        play = false;
                        break;

                    default:
                        Console.WriteLine("Рыбки стареют");
                        break;
                }

                Console.Clear();
                AddAgeFish();
            }
        }

        public void AddFish()
        {
            if (_fishes.Count > _maxFishCount)
            {
                Console.WriteLine("Аквариум переполнен, вы не можете добавить рыбок");
            }

            else
            {
                string fishName;
                int fishLife;
                bool isNumber;

                Console.Write("Введите имя новой рыбки - ");
                fishName = Console.ReadLine();

                Console.Write("\nВведите возраст новой рыбки - ");
                isNumber = Int32.TryParse(Console.ReadLine(), out fishLife);

                if (isNumber)
                {
                    if (fishLife >= 0)
                    {
                        _fishes.Add(new Fish(fishName, fishLife));
                        Console.WriteLine($"Вы добавили рыбку");
                    }

                    else
                    {
                        Console.WriteLine("Вы не можете добавить не родившуюся рыбку");
                    }
                }

                else
                {
                    Console.WriteLine("Возраст рыбки должен быть числом");
                }
            }
        }

        public void RemoveFish()
        {
            int fishIndex;
            bool isNumber;

            Console.Clear();
            ShowAllFishes();
            Console.Write("Какую рыбку вы хотите убрать - ");
            isNumber = Int32.TryParse(Console.ReadLine(), out fishIndex);

            if (isNumber)
            {
                if (fishIndex >= 0 && fishIndex < _fishes.Count)
                {
                    _fishes.RemoveAt(fishIndex);
                }

                else
                {
                    Console.WriteLine("Введён неверный номер рыбки");
                }
            }

            else
            {
                Console.WriteLine("Введено не число");
            }
        }

        public void AddAgeFish()
        {
            foreach (var fish in _fishes)
            {
                fish.AddAge();
            }
        }

        public void ShowAllFishes()
        {
            for (int i = 0; i < _fishes.Count; i++)
            {
                _fishes[i].ShowInfo();
            }
        }
    }
}
